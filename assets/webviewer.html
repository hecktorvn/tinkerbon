<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <style>
        body {
            font-family: sans-serif;
            padding: 10px;
        }

        button {
            padding: 8px 12px;
            margin-bottom: 10px;
            cursor: pointer;
        }

        pre>* {
            margin-bottom: 10px;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/{{theme}}.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"></script>
</head>

<body>
    <button onclick="run()" id="run">Executar Tinker</button>

    <h1>Resultado:</h1>
    
    <pre id="output">(resultado aparecer√° aqui)</pre>

    <script>
        const vscode = acquireVsCodeApi();

        function run() {
            vscode.postMessage({ command: 'run' });
        }

        window.addEventListener('message', event => {
            const { command, output } = event.data;
            if (command === 'output') {
                let outputs = JSON.parse(output);

                outputs = outputs.map(line => typeof line === 'object' ? JSON.stringify(line, null, 2) : line);
                document.getElementById('output').innerHTML = '';

                outputs.forEach(line => {
                    const element = document.createElement('code');
                    element.className = 'language-json';
                    element.textContent = line;

                    console.log({ element, line })
                    document.getElementById('output').appendChild(element);
                });

                hljs.highlightAll();
            }

            if (command === 'error') {
                console.log({event});
                document.getElementById('output').innerText = output;
            }
        });
    </script>
</body>

</html>